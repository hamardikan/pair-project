<%- include('../partials/head') %>
<%- include('../partials/navbar') %>
<div class="max-w-4xl mx-auto px-4 py-10">
    <form action="/posts" method="POST" class="space-y-8" onsubmit="return submitForm()">
        <!-- Title Input -->
        <div>
            <input type="text"
                   name="title"
                   placeholder="Title"
                   class="w-full text-5xl font-bold serif-pro border-none focus:outline-none focus:ring-0"
                   required>
        </div>

        <!-- Image URL Input -->
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Cover Image URL</label>
            <input type="url"
                   name="imgUrl"
                   placeholder="https://example.com/image.jpg"
                   class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-green-500">
            <p class="mt-1 text-sm text-gray-500">Add a cover image URL for your post (optional)</p>
        </div>

        <!-- Quill Editor -->
        <div>
            <div id="editor" class="h-96"></div>
            <input type="hidden" name="content" id="hiddenContent">
        </div>

        <!-- Tags Input -->
        <div>
            <input type="text"
                   name="tags"
                   placeholder="Add tags (comma separated)"
                   class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-green-500">
        </div>

        <!-- Submit Button -->
        <div class="flex justify-end">
            <button type="submit"
                    class="px-6 py-2 bg-green-600 text-white rounded-full hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
                Publish
            </button>
        </div>
    </form>
</div>

<script>
var quill = new Quill('#editor', {
    theme: 'snow',
    placeholder: 'Write your story...',
    modules: {
        toolbar: [
            [{ 'header': [1, 2, false] }],
            ['bold', 'italic', 'underline'],
            ['link', 'blockquote', 'code-block'],
            [{ 'list': 'ordered'}, { 'list': 'bullet' }],
            ['image'],
            ['clean']
        ]
    }
});

function submitForm() {
    var content = document.querySelector('#hiddenContent');
    var editorContent = quill.root.innerHTML;
    
    // Check if editor is empty (only contains empty paragraph)
    if (editorContent === '<p><br></p>') {
        alert('Please write some content');
        return false;
    }
    
    content.value = editorContent;
    return true;
}
</script>
<%- include('../partials/footer') %>